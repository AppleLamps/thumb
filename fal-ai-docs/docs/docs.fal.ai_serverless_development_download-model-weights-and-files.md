---
url: "https://docs.fal.ai/serverless/development/download-model-weights-and-files"
title: "Download Model Weights and Files - fal"
---

[Skip to main content](https://docs.fal.ai/serverless/development/download-model-weights-and-files#content-area)

[fal home page![light logo](https://mintcdn.com/fal-d8505a2e/_1QeqsRe91WUAOCJ/logo/light.svg?fit=max&auto=format&n=_1QeqsRe91WUAOCJ&q=85&s=04c374284984bf56c89974379f02b7a2)![dark logo](https://mintcdn.com/fal-d8505a2e/_1QeqsRe91WUAOCJ/logo/dark.svg?fit=max&auto=format&n=_1QeqsRe91WUAOCJ&q=85&s=b136c77964ac416a72cb0bcba775d7c7)](https://fal.ai/)

Search...

Ctrl KAsk AI

Search...

Navigation

Development

Download Model Weights and Files

[![https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/home.svg](https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/home.svg)Home](https://docs.fal.ai/) [![https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/ar-cube-1.svg](https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/ar-cube-1.svg)Model APIs](https://docs.fal.ai/model-apis) [![https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/rocket.svg](https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/rocket.svg)Serverless](https://docs.fal.ai/serverless) [![https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/chip.svg](https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/chip.svg)Compute](https://docs.fal.ai/compute) [![https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/file-json.svg](https://mintlify.s3.us-west-1.amazonaws.com/fal-d8505a2e/images/icons/file-json.svg)Platform APIs](https://docs.fal.ai/platform-apis) [Changelog](https://docs.fal.ai/changelog)

- [Status](https://status.fal.ai/)
- [Community](https://discord.gg/fal-ai)
- [Blog](https://blog.fal.ai/)

- [Introduction](https://docs.fal.ai/serverless)

- [Connect to Cursor](https://docs.fal.ai/serverless/mcp)

##### Getting Started

- [Quick Start](https://docs.fal.ai/serverless/getting-started/quick-start)
- [Deploy Your First Image Generator](https://docs.fal.ai/serverless/getting-started/deploy-your-first-image-generator)
- [Installation & Setup](https://docs.fal.ai/serverless/getting-started/installation)
- [Core Concepts](https://docs.fal.ai/serverless/getting-started/core-concepts)

##### Tutorials

- [Deploy a Text-to-Image Model](https://docs.fal.ai/serverless/tutorials/deploy-text-to-image-model)
- [Deploy a Text-to-Video Model](https://docs.fal.ai/serverless/tutorials/deploy-text-to-video-model)
- [Deploy a Text-to-Speech Model](https://docs.fal.ai/serverless/tutorials/deploy-text-to-speech-model)
- [Deploy a Text-to-Music Model](https://docs.fal.ai/serverless/tutorials/deploy-text-to-music-model)
- [Deploy a ComfyUI SDXL Turbo App](https://docs.fal.ai/serverless/tutorials/deploy-comfyui-server)
- [Deploy Multi-GPU Inference](https://docs.fal.ai/serverless/tutorials/deploy-multi-gpu-inference)
- [Deploy Models with Custom Containers](https://docs.fal.ai/serverless/tutorials/deploy-models-with-custom-containers)

##### Deployment & Operations

- [Deploy to Production](https://docs.fal.ai/serverless/deployment-operations/deploy-to-production)
- [Manage Deployments](https://docs.fal.ai/serverless/deployment-operations/manage-deployments)
- [Manage Secrets Securely](https://docs.fal.ai/serverless/deployment-operations/manage-secrets-securely)
- [Monitor Performance](https://docs.fal.ai/serverless/deployment-operations/monitor-performance)
- [Scale Your Application](https://docs.fal.ai/serverless/deployment-operations/scale-your-application)

##### Development

- [Handle Inputs and Outputs](https://docs.fal.ai/serverless/development/handle-inputs-and-outputs)
- [Download Model Weights and Files](https://docs.fal.ai/serverless/development/download-model-weights-and-files)
- [Import Code](https://docs.fal.ai/serverless/development/import-code)
- [Use Persistent Storage](https://docs.fal.ai/serverless/development/use-persistent-storage)
- [Streaming Endpoints](https://docs.fal.ai/serverless/development/streaming)
- [Realtime Endpoints](https://docs.fal.ai/serverless/development/realtime)
- [Test Models and Endpoints](https://docs.fal.ai/serverless/development/test-models-and-endpoints)
- [Use a Custom Container Image](https://docs.fal.ai/serverless/development/use-custom-container-image)
- [Handle request cancellations](https://docs.fal.ai/serverless/development/handle-cancellations)
- [Use KV Store](https://docs.fal.ai/serverless/development/use-kv-store)
- [Add Health Check Endpoint](https://docs.fal.ai/serverless/development/add-health-check-endpoint)

##### Multi-GPU Workloads

- [Overview](https://docs.fal.ai/serverless/distributed/overview)
- [Event Streaming](https://docs.fal.ai/serverless/distributed/streaming)
- [API Reference](https://docs.fal.ai/serverless/distributed/api-reference)

##### Advanced Optimizations

- [Optimize Routing Behavior](https://docs.fal.ai/serverless/optimizations/optimize-routing-behavior)
- [Optimize Model Performance](https://docs.fal.ai/serverless/optimizations/optimize-model-performance)
- [Optimize Startup with Compiled Caches](https://docs.fal.ai/serverless/optimizations/optimize-startup-with-compiled-caches)
- [Optimize Container Images](https://docs.fal.ai/serverless/optimizations/optimize-container-images)

##### Migrations

- [Migrate an External Docker Server](https://docs.fal.ai/serverless/migrations/migrate-external-docker-server)
- [Migrate from Replicate](https://docs.fal.ai/serverless/migrations/migrate-from-replicate)

##### CLI Reference

- [Installation](https://docs.fal.ai/serverless/cli/installation)
- [fal auth](https://docs.fal.ai/serverless/cli/auth)
- fal apps

- [fal deploy](https://docs.fal.ai/serverless/cli/deploy)
- [fal files](https://docs.fal.ai/serverless/cli/files)
- [fal run](https://docs.fal.ai/serverless/cli/run)
- [fal queue](https://docs.fal.ai/serverless/cli/queue)
- [fal keys](https://docs.fal.ai/serverless/cli/keys)
- [fal profile](https://docs.fal.ai/serverless/cli/profile)
- [fal secrets](https://docs.fal.ai/serverless/cli/secrets)
- [fal doctor](https://docs.fal.ai/serverless/cli/doctor)
- [fal create](https://docs.fal.ai/serverless/cli/create)
- [fal runners](https://docs.fal.ai/serverless/cli/runners)

##### Python SDK

- [fal.App Class Reference](https://docs.fal.ai/serverless/python/fal-app-reference)
- [fal.api.SyncServerlessClient](https://docs.fal.ai/serverless/python/client)
- [Python SDK API Reference](https://docs.fal.ai/serverless/python/api-reference)

##### API Reference

- [Platform APIs for Serverless](https://docs.fal.ai/serverless/platform-apis)

On this page

- [Downloading Files](https://docs.fal.ai/serverless/development/download-model-weights-and-files#downloading-files)
- [Downloading Model Weights](https://docs.fal.ai/serverless/development/download-model-weights-and-files#downloading-model-weights)
- [Improving Hugging Face download speeds](https://docs.fal.ai/serverless/development/download-model-weights-and-files#improving-hugging-face-download-speeds)
- [Set Hugging Face token](https://docs.fal.ai/serverless/development/download-model-weights-and-files#set-hugging-face-token)
- [Save weights to the /data volume](https://docs.fal.ai/serverless/development/download-model-weights-and-files#save-weights-to-the-%2Fdata-volume)
- [Speed up initial weights downloading](https://docs.fal.ai/serverless/development/download-model-weights-and-files#speed-up-initial-weights-downloading)
- [Speed up model files check](https://docs.fal.ai/serverless/development/download-model-weights-and-files#speed-up-model-files-check)
- [Speed up model loads](https://docs.fal.ai/serverless/development/download-model-weights-and-files#speed-up-model-loads)
- [Caching Compiled Kernels](https://docs.fal.ai/serverless/development/download-model-weights-and-files#caching-compiled-kernels)

## [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#downloading-files)  Downloading Files

You can download files from external sources using the `download_file` function. This function handles downloading files from URLs with built-in caching and error handling.This is particularly useful for downloading datasets, configuration files, or any external resources your application needs.

Report incorrect code

Copy

Ask AI

```
from fal.toolkit import download_file, FAL_PERSISTENT_DIR

class MyApp(fal.App):
    def setup(self):
        path = download_file(
            "https://example.com/myfile.txt",
            FAL_PERSISTENT_DIR / "mydir",
        )
        ...
```

## [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#downloading-model-weights)  Downloading Model Weights

You can download model weights from external sources using the `download_model_weights` function. This function is specifically designed for downloading model weights and provides several useful features:

- **Predefined storage location**: Automatically stores weights in an optimized directory structure
- **Smart caching**: Avoids re-downloading weights that are already present unless forced
- **Authentication support**: Supports custom request headers for private repositories

This function is particularly useful for downloading pre-trained model weights from Hugging Face, custom model repositories, or private storage locations.

Report incorrect code

Copy

Ask AI

```
from fal.toolkit import download_model_weights

class MyApp(fal.App):
    def setup(self):
        path = download_model_weights(
            "https://example.com/myfile.txt",
            # Optional: force download even if the weights are already present
            force=False,
            # Optional: specify request headers
            request_headers={
                "Authorization": "Bearer <token>",
            },
        )
        ...
```

## [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#improving-hugging-face-download-speeds)  Improving Hugging Face download speeds

The Hugging Face library caches files locally to prevent duplicate downloads. Within Fal, this cache is automatically placed on the [`/data` persistent volume](https://docs.fal.ai/serverless/development/use-persistent-storage) via the `HF_HOME` environment variable that is set to `/data/.cache/huggingface`.The steps below offer additional speedups.

### [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#set-hugging-face-token)  Set Hugging Face token

Ensure you have your Hugging Face token set to be used by Fal runs. Authenticated downloads seem to be faster than anonymous ones:`fal secret set HF_TOKEN=xxx`

### [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#save-weights-to-the-/data-volume)  Save weights to the `/data` volume

Hugging Face weights need to be stored within the `/data` volume. This:

- Speeds up runner starts by removing the need for files to be reconstructed from the cache (which is already on `/data`)
- Ensures enough disk space is available

Report incorrect code

Copy

Ask AI

```
snapshot_download(
    repo_id=model_id,
    local_dir="/data/models/deepseek-ai",
    ...
)
```

### [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#speed-up-initial-weights-downloading)  Speed up initial weights downloading

Depending on the size of the weights, the initial call to `snapshot_download` can take a while.Hugging Face seems to reduce download speeds for large models after some time. While individual transfer thread often start at 50+ MB/s, after a while the speed drops to 5-6 MB/s.There are 3 ways to speed up downloads:

- Increase concurrency, `max_workers` and cache size:






Report incorrect code







Copy







Ask AI











```
os.environ["HF_XET_HIGH_PERFORMANCE"] = "1"
os.environ["HF_XET_CHUNK_CACHE_SIZE_BYTES"] = "1000000000000"
os.environ["HF_XET_NUM_CONCURRENT_RANGE_GETS"] = "32"

snapshot_download(
      repo_id=model_id,
      local_dir=model_dir,
      max_workers=32
)
```

- Download many models in parallel: when downloading multiple models, it helps to start a separate Fal run for each one. The different source IP address reduces the risk of rate limiting.
- Restart slow downloads: restart the run after e.g. 10 minutes, which will likely cause it to go to a different physical server, and the download will resume at higher speeds.

### [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#speed-up-model-files-check)  Speed up model files check

Even after fully caching weights, calling `snapshot_download` with a large model can sometimes take 45+ seconds.The Hugging Face library takes this time to do API calls and metadata checks. You can use `local_files_only=True` to skip this step, which typically makes the call return in less than 1 second.Using `local_files_only=True` will throw an error if the files are not completely cached. To prevent that, it is a good idea to wrap the call in a try/catch block and retry it without `local_files_only`:

Report incorrect code

Copy

Ask AI

```
from huggingface_hub.errors import LocalEntryNotFoundError

try:
    snapshot_download(
        ...
        local_files_only=True,
    )
except LocalEntryNotFoundError:
    snapshot_download(
        ...
    )
```

### [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#speed-up-model-loads)  Speed up model loads

Hugging face models are typically split into multiple files, and loading them happens serially. This is sub-optimal if the files are not cached locally as they will be fetched one by one.It is advisable to pre-read all the files in parallel which will create missing caches concurrently, at much higher speeds.Please refer to [Sequential vs parallel reading](https://docs.fal.ai/serverless/development/use-persistent-storage#sequential-vs-parallel-reading).

## [â€‹](https://docs.fal.ai/serverless/development/download-model-weights-and-files\#caching-compiled-kernels)  Caching Compiled Kernels

Once your model weights are stored on `/data`, you can also cache compiled PyTorch kernels to `/data/inductor-caches/`. This is particularly useful for models using `torch.compile()`, as it avoids recompiling kernels on every worker startup.

Learn how to share compiled kernels across workers in [Optimize Startup with Compiled Caches](https://docs.fal.ai/serverless/optimizations/optimize-startup-with-compiled-caches).

Was this page helpful?

YesNo

[Handle Inputs and Outputs\\
\\
Previous](https://docs.fal.ai/serverless/development/handle-inputs-and-outputs) [Import Code\\
\\
Next](https://docs.fal.ai/serverless/development/import-code)

Ctrl+I

### ðŸ”’ Need Serverless Access?

Ã—

Don't have access to fal Serverless yet? Request access to deploy your custom models with instant GPU scaling.


[Request Access](https://fal.ai/dashboard/serverless-get-started)

Assistant

Responses are generated using AI and may contain mistakes.

[Create support ticket](mailto:support@fal.ai)